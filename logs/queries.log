1742575083.256253,127.0.0.1,b'select * from ;'
1742575115.538653,127.0.0.1,b'select * from users;'
1742575179.3039382,127.0.0.1,b'SELECT * FROM users'
1742575189.359801,127.0.0.1,b'SELECT * FROM users'
1742575199.416141,127.0.0.1,b'SELECT * FROM users'
1742576271.5375738,127.0.0.1,b'select * from users;'
1742592536.8280058,127.0.0.1,b'select * from users;'
1742594515.987194,127.0.0.1,b'select * from users;'
1742594555.1665852,127.0.0.1,b'select * from users;'
1742594556.662953,127.0.0.1,b'\x1b[A'
1742594558.651307,127.0.0.1,b'\x1b[A\x1b\x1b[A'
1742594601.314914,127.0.0.1,b'SELECT * FROM users;'
1742594602.588893,127.0.0.1,b'SELECT * FROM users;'
1742594604.0238929,127.0.0.1,b'SELECT * FROM users;'
1742594611.888715,127.0.0.1,b'SELECT * FROM users;'
1742594612.048419,127.0.0.1,b'SELECT * FROM users;'
1742594612.2132852,127.0.0.1,b'SELECT * FROM users;'
1742594678.244833,127.0.0.1,b'SELECT * FROM users;'
1742594686.323362,127.0.0.1,b'SELECT * FROM users;'
1742594694.296659,127.0.0.1,b'SELECT * FROM users;'
1742594753.080239,127.0.0.1,b'SELECT * FROM users;'
1742594753.792309,127.0.0.1,b'SELECT * FROM users;'
1742594753.96793,127.0.0.1,b'SELECT * FROM users;'
1742594810.852948,127.0.0.1,b'SELECT * FROM users;'
1742594811.025852,127.0.0.1,b'SELECT * FROM users;'
1742594811.1919832,127.0.0.1,b'SELECT * FROM users;'
1742596101.4960551,127.0.0.1,b'select * from users;'
1742596129.977837,127.0.0.1,b'test abc;'
1742597052.796949,127.0.0.1,b'select * from users;'
1742597053.802229,127.0.0.1,b'select * from users;'
1742597054.805162,127.0.0.1,b'select * from users;'
1742597851.2881851,127.0.0.1,b'select * from users;'
1742597867.7763689,127.0.0.1,b'select * from users;'
1742599776.188187,127.0.0.1,b'select * from users;'
1742601171.486327,127.0.0.1,b'select * from users;'
1742601453.250409,127.0.0.1,b'select * from users;'
1742601493.531729,127.0.0.1,b'select ;'
1742602241.0290968,127.0.0.1,b'select * from users;'
1742602318.6968682,127.0.0.1,b'select * from users;'
1742602491.9143438,127.0.0.1,b'select * from users;'
1742602509.8274748,127.0.0.1,b'select * from abc;'
1742602540.2256901,127.0.0.1,b'select * from users;'
1742603008.576801,127.0.0.1,b'select select * from users;'
1742603013.775394,127.0.0.1,b'select * from users;'
1742603480.676574,127.0.0.1,b'sele'
1742603507.042742,127.0.0.1,b'sdfsdf'
1742603695.701698,127.0.0.1,b'select * from users;'
1742603697.381258,127.0.0.1,b'from colorama import Fore, Style, init'
1742603697.388355,127.0.0.1,b'self.socket = None'
1742603697.395658,127.0.0.1,b'self.socket.connect((self.host, self.port))'
1742603697.4002922,127.0.0.1,b'print(f"{Fore.RED}Error: Connection refused. Is the server running?{Style.RESET_ALL}")'
1742603697.403935,127.0.0.1,b'def disconnect(self):'
1742603697.4075258,127.0.0.1,b'print(f"{Fore.YELLOW}Disconnected from server{Style.RESET_ALL}")'
1742603697.410727,127.0.0.1,b'print(f"{Fore.RED}Not connected to server{Style.RESET_ALL}")'
1742603697.413722,127.0.0.1,b'print(f"{Fore.YELLOW}Sending: {query}{Style.RESET_ALL}")'
1742603697.4167092,127.0.0.1,b'self.socket.settimeout(10.0)  # 10 second timeout'
1742603697.4193542,127.0.0.1,b'try:'
1742603697.421998,127.0.0.1,b'chunks.append(chunk)'
1742603697.424572,127.0.0.1,b'self.socket.settimeout(0.5)'
1742603697.4273438,127.0.0.1,b'self.socket.settimeout(None)  # Reset timeout'
1742603697.430261,127.0.0.1,b"response = b''.join(chunks)"
1742603697.432854,127.0.0.1,b"return response.decode('utf-8')"
1742603697.43581,127.0.0.1,b'return None'
1742603697.4385111,127.0.0.1,b'return None'
1742603697.44088,127.0.0.1,b'success_count = 0'
1742603697.4433632,127.0.0.1,b'sys.stdout.flush()'
1742603697.44607,127.0.0.1,b'# Add delay between queries'
1742603697.448639,127.0.0.1,b'queries_per_sec = count / duration if duration > 0 else 0'
1742603697.4512918,127.0.0.1,b'print(f"  Rate: {queries_per_sec:.2f} queries/second")'
1742603697.4538932,127.0.0.1,b'print("Type your SQL queries (type \'exit\' to quit, \'stress\' for stress test):")'
1742603697.456383,127.0.0.1,b"if user_input.lower() == 'exit':"
1742603697.4587579,127.0.0.1,b'test_query = input("Enter query to use for stress test: ")'
1742603697.4612749,127.0.0.1,b'client.stress_test(test_query, count, delay)'
1742603697.463563,127.0.0.1,b'# Send the query'
1742603697.46589,127.0.0.1,b'print(f"{Fore.CYAN}=== Response ==={Style.RESET_ALL}")'
1742603697.468192,127.0.0.1,b"parser = argparse.ArgumentParser(description='Database Client for Testing DDoS Protection')"
1742603697.470603,127.0.0.1,b"parser.add_argument('--query', help='Query to use for stress test')"
1742603697.472851,127.0.0.1,b'# Create client and connect'
1742603697.4750211,127.0.0.1,b'if args.stress and args.query:'
1742603697.477531,127.0.0.1,b'# Start interactive mode'
1742603697.479917,127.0.0.1,b'if __name__ == "__main__":'
1742603700.331626,127.0.0.1,b'sdf'
1742603779.158588,127.0.0.1,b'select * from users;'
1742603797.544626,127.0.0.1,b'select * from users;'
1742603809.9042501,127.0.0.1,b'select * from users;'
1742603811.686163,127.0.0.1,b'select * from users;'
1742603812.473194,127.0.0.1,b'select * from users;'
1742603813.270953,127.0.0.1,b'select * from users;'
1742603814.040595,127.0.0.1,b'select * from users;'
1742603814.823648,127.0.0.1,b'select * from users;'
1742603815.608047,127.0.0.1,b'select * from users;'
1742603816.398589,127.0.0.1,b'select * from users;'
1742603817.164974,127.0.0.1,b'select * from users;'
1742603817.9480908,127.0.0.1,b'select * from users;'
1742603818.4675379,127.0.0.1,b'select * from users;'
1742603819.262811,127.0.0.1,b'select * from users;'
1742603820.3900852,127.0.0.1,b'select * from users;'
1742604102.101186,127.0.0.1,b'select * from users;'
1742604400.9258199,127.0.0.1,b'SELECT * FROM users;'
1742604401.432373,127.0.0.1,b'SELECT * FROM users;'
1742604401.936828,127.0.0.1,b'SELECT * FROM users;'
1742604855.300642,127.0.0.1,b'X-Client-IP: 81.146.169.166\r\n\r\nX-Client-IP: 81.146.169.166\r\n\r\nSELECT * FROM users;'
1742604855.807155,127.0.0.1,b'X-Client-IP: 70.29.112.122\r\n\r\nX-Client-IP: 70.29.112.122\r\n\r\nSELECT * FROM users;'
1742604856.310957,127.0.0.1,b'X-Client-IP: 20.15.215.190\r\n\r\nX-Client-IP: 20.15.215.190\r\n\r\nSELECT * FROM users;'
1742604857.319616,127.0.0.1,b'X-Client-IP: 81.146.169.166\r\n\r\n'
1742604868.39687,127.0.0.1,b'select * from users;'
1742604898.7049658,127.0.0.1,b'select * from users;'
1742604911.6118321,127.0.0.1,b'select * from users;'
1742604912.880057,127.0.0.1,b'select * from users;'
1742604914.4915252,127.0.0.1,b'select * from users;'
1742604921.145244,127.0.0.1,b'select * from users;'
1742604921.870247,127.0.0.1,b'select * from users;'
1742604922.553684,127.0.0.1,b'select * from users;'
1742604922.992146,127.0.0.1,b'select * from users;'
1742604923.430167,127.0.0.1,b'select * from users;'
1742604924.111574,127.0.0.1,b'select * from users;'
1742604924.7611048,127.0.0.1,b'select * from users;'
1743473570.813675,127.0.0.1,b'select * from users;'
1743473628.084129,127.0.0.1,b'exitg'
1743473646.266155,127.0.0.1,b'select * from users;'
1743473998.206174,127.0.0.1,b'select * from users;'
1743476565.1148071,127.0.0.1,select * from users;
1743476612.1232572,127.0.0.1,b'select * from users;'
1743476627.670431,127.0.0.1,b'select * from users;'
1743477799.549622,127.0.0.1,b'import threading'
1743477799.569938,127.0.0.1,b'import yaml'
1743477799.5738518,127.0.0.1,b'import re'
1743477799.577324,127.0.0.1,b'# Initialize colorama for cross-platform colored terminal output'
1743477799.5808709,127.0.0.1,b"if not os.path.exists('logs'):"
1743477799.584057,127.0.0.1,b'logging.basicConfig('
1743477799.587127,127.0.0.1,b"format='%(asctime)s - %(levelname)s - %(message)s'"
1743477799.5904078,127.0.0.1,b"def __init__(self, config_path='config/server.yml'):"
1743477799.5938041,127.0.0.1,b"self.listen_port = config['server']['listen_port']"
1743477799.597096,127.0.0.1,b"self.db_name = config['database']['db_name']"
1743477799.600071,127.0.0.1,b"self.window_size = config['detection']['window_size']"
1743477799.602855,127.0.0.1,b'self.connection_count = 0'
1743477799.605435,127.0.0.1,b'def start(self):'
1743477799.6080298,127.0.0.1,b'# Allow port reuse'
1743477799.61054,127.0.0.1,b"server.bind(('0.0.0.0', self.listen_port))"
1743477799.613413,127.0.0.1,b'logger.info(f"Server listening on port {self.listen_port}")'
1743477799.616159,127.0.0.1,b'while True:'
1743477799.618732,127.0.0.1,b'# Handle each client in a separate thread'
1743477799.621448,127.0.0.1,b'except KeyboardInterrupt:'
1743477799.62433,127.0.0.1,b'logger.error(f"Server error: {str(e)}")'
1743477799.626692,127.0.0.1,b'"""Handle a client connection"""'
1743477799.629277,127.0.0.1,b'data = client_socket.recv(4096)'
1743477799.631618,127.0.0.1,b'return'
1743477799.6340961,127.0.0.1,b'try:'
1743477799.636487,127.0.0.1,b'port=self.db_port,'
1743477799.638816,127.0.0.1,b')'
1743477799.641407,127.0.0.1,b"query_str = data.decode('utf-8')"
1743477799.6439738,127.0.0.1,b'cursor.execute(query_str)'
1743477799.646792,127.0.0.1,b'column_names = [desc[0] for desc in cursor.description]'
1743477799.6492732,127.0.0.1,b'response += "-" * (sum(len(name) for name in column_names) + (3 * (len(column_names) - 1))) + "\\n"'
1743477799.651552,127.0.0.1,b'client_socket.send(response.encode())'
1743477799.653913,127.0.0.1,b'# Commit the transaction'
1743477799.65622,127.0.0.1,b'db_conn.close()'
1743477799.6584551,127.0.0.1,b'else:'
1743477799.660904,127.0.0.1,b'client_socket.send(f"ERROR: {error_msg}\\n".encode())'
1743477799.6632729,127.0.0.1,b'logger.error(error_msg)'
1743477799.665618,127.0.0.1,b'finally:'
1743477799.6680691,127.0.0.1,b'"""Forward data between sockets and log the traffic"""'
1743477799.670369,127.0.0.1,b'if not data:'
1743477799.672538,127.0.0.1,b'# This is a query from client to DB - log it'
1743477799.674776,127.0.0.1,b'except UnicodeDecodeError:'
1743477799.677136,127.0.0.1,b'try:'
1743477799.679421,127.0.0.1,b'# Forward data'
1743477799.68199,127.0.0.1,b'def log_query(self, client_ip, data):'
1743477799.684335,127.0.0.1,b"with open('logs/queries.log', 'a') as log_file:"
1743477799.686791,127.0.0.1,b'self.query_counts[client_ip].append((now, 1))'
1743477799.6892211,127.0.0.1,b'if now - ts < self.window_size'
1743477799.691562,127.0.0.1,b'while True:'
1743477799.6939242,127.0.0.1,b'uptime_str = f"{int(uptime // 3600):02d}:{int((uptime % 3600) // 60):02d}:{int(uptime % 60):02d}"'
1743477799.696297,127.0.0.1,b'print(f"{Fore.GREEN}===== DB Monitor Statistics ====={Style.RESET_ALL}")'
1743477799.698636,127.0.0.1,b'print(f"Database: {self.db_type} on {self.db_host}:{self.db_port}")'
1743477799.7009192,127.0.0.1,b'if not self.query_counts:'
1743477799.703126,127.0.0.1,b'now = time.time()'
1743477799.705329,127.0.0.1,b'if valid_queries:'
1743477799.7101178,127.0.0.1,b'rate = (total / window) * 60'
1743477799.7127428,127.0.0.1,b'if __name__ == "__main__":'
1743477799.715044,127.0.0.1,b'print(f"{Fore.RED}Fatal error: {str(e)}{Style.RESET_ALL}")'
1743477810.20069,127.0.0.1,b'select * from users;'
1743477830.4759722,127.0.0.1,b'select * from users;'
1743477831.999375,127.0.0.1,b'select * from users;'
1743477833.517184,127.0.0.1,b'select * from users;'
1743477860.8453062,127.0.0.1,b'select * from users;'
1743477882.225099,127.0.0.1,b'select * from users;'
1743477953.968458,127.0.0.1,b'select * from users;'
1743477964.343283,127.0.0.1,b'select * from users;'
1743477965.481876,127.0.0.1,b'select * from users;'
1743477967.315642,127.0.0.1,b'select * from users;'
1743478094.633255,127.0.0.1,b'select * form users;'
1743478096.091145,127.0.0.1,b'select * form users;'
1743478097.098002,127.0.0.1,b'select * form users;'
1743478107.446958,127.0.0.1,b'select * from users;'
1743478108.498038,127.0.0.1,b'select * from users;'
1743478109.694037,127.0.0.1,b'select * from users;'
1743478110.8363829,127.0.0.1,b'select * from users;'
1743478111.951752,127.0.0.1,b'select * from users;'
1743478112.460757,127.0.0.1,b'select * from users;'
1743478112.970156,127.0.0.1,b'select * from users;'
1743478113.479964,127.0.0.1,b'select * from users;'
1743478113.9896598,127.0.0.1,b'select * from users;'
1743478114.5001118,127.0.0.1,b'select * from users;'
1743478115.0100648,127.0.0.1,b'select * from users;'
1743478115.519825,127.0.0.1,b'select * from users;'
1743478116.029786,127.0.0.1,b'select * from users;'
1743478116.538456,127.0.0.1,b'select * from users;'
1743478117.04942,127.0.0.1,b'select * from users;'
1743478117.5577118,127.0.0.1,b'select * from users;'
1743478118.065666,127.0.0.1,b'select * from users;'
1743478118.574524,127.0.0.1,b'select * from users;'
1743478119.084436,127.0.0.1,b'select * from users;'
1743478119.594409,127.0.0.1,b'select * from users;'
1743478120.1054358,127.0.0.1,b'select * from users;'
1743478120.6148741,127.0.0.1,b'select * from users;'
1743478121.125101,127.0.0.1,b'select * from users;'
